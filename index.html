<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Math Partner & Calculator</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
    body { background: #fff6fe; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding: 20px; gap: 20px; flex-wrap: wrap; }
    
    /* Calculator Styling */
    .calculator { background: #fff; width: 320px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
    .display-area { padding: 20px; background: #fafafa; text-align: right; border-bottom: 1px solid #eee; }
    #history-display { font-size: 14px; color: #888; height: 20px; margin-bottom: 5px; }
    #main-display { font-size: 40px; font-weight: 600; width: 100%; border: none; text-align: right; background: transparent; outline: none; }
    
    .buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1px; background: #eee; }
    button { height: 60px; border: none; background: #fff; font-size: 18px; cursor: pointer; transition: 0.2s; }
    button:hover { background: #fdf2fb; }
    .operator { background: #dc6bba; color: white; font-size: 22px; }
    .operator:hover { background: #c95aa7; }
    .equal { background: #a34582; color: white; font-weight: bold; }
    
    /* Side Panel Styling */
    .side-panel { width: 400px; background: #fff; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; height: 620px; }
    .tabs { display: flex; background: #f5f5f5; border-bottom: 2px solid #dc6bba; }
    .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-weight: 600; color: #666; }
    .tab.active { background: #fff; color: #dc6bba; }
    
    .content { flex: 1; padding: 20px; overflow-y: auto; display: none; }
    .content.active { display: flex; flex-direction: column; }
    
    /* Chat Styling */
    .chat-container { flex: 1; overflow-y: auto; background: #fafafa; padding: 10px; border-radius: 8px; display: flex; flex-direction: column; gap: 10px; }
    .chat-msg { padding: 10px 14px; border-radius: 12px; font-size: 14px; max-width: 85%; line-height: 1.4; }
    .ai { background: #fcdcf9; color: #333; align-self: flex-start; border-bottom-left-radius: 2px; }
    .user { background: #dc6bba; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
    
    .input-row { display: flex; gap: 10px; margin-top: 15px; }
    input[type="text"] { flex: 1; padding: 12px; border: 2px solid #dc6bba; border-radius: 8px; outline: none; }
    .send-btn { background: #dc6bba; color: white; border: none; padding: 0 20px; border-radius: 8px; cursor: pointer; font-weight: bold; }
  </style>
</head>
<body>

  <div class="calculator">
    <div class="display-area">
      <div id="history-display"></div>
      <input type="text" id="main-display" value="0" readonly>
    </div>
    <div class="buttons">
      <button onclick="clearDisplay()">C</button>
      <button onclick="deleteLast()">âŒ«</button>
      <button onclick="appendOp('/')" class="operator">Ã·</button>
      <button onclick="appendOp('*')" class="operator">Ã—</button>
      
      <button onclick="appendNum('7')">7</button>
      <button onclick="appendNum('8')">8</button>
      <button onclick="appendNum('9')">9</button>
      <button onclick="appendOp('-')" class="operator">âˆ’</button>
      
      <button onclick="appendNum('4')">4</button>
      <button onclick="appendNum('5')">5</button>
      <button onclick="appendNum('6')">6</button>
      <button onclick="appendOp('+')" class="operator">+</button>
      
      <button onclick="appendNum('1')">1</button>
      <button onclick="appendNum('2')">2</button>
      <button onclick="appendNum('3')">3</button>
      <button onclick="calculate()" class="equal" style="grid-row: span 2">=</button>
      
      <button onclick="appendNum('0')" style="grid-column: span 2">0</button>
      <button onclick="appendNum('.')">.</button>
    </div>
  </div>

  <div class="side-panel">
    <div class="tabs">
      <div class="tab active" onclick="switchTab('ai-tab')">ðŸ’¬ AI Assistant</div>
      <div class="tab" onclick="switchTab('history-tab')">ðŸ“‹ History</div>
    </div>
    
    <div id="ai-tab" class="content active">
      <div class="chat-container" id="chat-box">
        <div class="chat-msg ai"><strong>ðŸ‘‹ Hi there!</strong> I'm your Math Partner. I can help explain concepts while you calculate. Try asking: <em>"What is a prime number?"</em></div>
      </div>
      <div class="input-row">
        <input type="text" id="ai-input" placeholder="Ask a math question...">
        <button class="send-btn" onclick="handleAI()">Ask</button>
      </div>
    </div>

    <div id="history-tab" class="content">
      <div id="history-list" style="color: #666; font-size: 14px;">No calculations yet.</div>
    </div>
  </div>

  <script>
    const mainDisplay = document.getElementById('main-display');
    const histDisplay = document.getElementById('history-display');
    let historyEntries = [];

    // --- CALCULATOR LOGIC ---
    function appendNum(n) {
      if (mainDisplay.value === '0') mainDisplay.value = n;
      else mainDisplay.value += n;
    }

    function appendOp(op) {
      const last = mainDisplay.value.slice(-1);
      if (['+','-','*','/'].includes(last)) {
        mainDisplay.value = mainDisplay.value.slice(0, -1) + op;
      } else {
        mainDisplay.value += op;
      }
    }

    function clearDisplay() {
      mainDisplay.value = '0';
      histDisplay.innerText = '';
    }

    function deleteLast() {
      mainDisplay.value = mainDisplay.value.slice(0, -1) || '0';
    }

    function calculate() {
      try {
        const expression = mainDisplay.value;
        const result = eval(expression);
        histDisplay.innerText = expression + ' =';
        mainDisplay.value = result;
        
        // Save to history tab
        historyEntries.push(`${expression} = ${result}`);
        updateHistoryUI();
      } catch (e) {
        mainDisplay.value = "Error";
      }
    }

    function updateHistoryUI() {
      const list = document.getElementById('history-list');
      list.innerHTML = historyEntries.map(item => 
        `<div style="padding:10px; border-bottom:1px solid #eee; background:#fff">${item}</div>`
      ).reverse().join('');
    }

    // --- AI LOGIC ---
    function switchTab(id) {
      document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      event.currentTarget.classList.add('active');
    }

    function addMessage(text, sender) {
      const msg = document.createElement('div');
      msg.className = `chat-msg ${sender}`;
      msg.innerHTML = text;
      const box = document.getElementById('chat-box');
      box.appendChild(msg);
      box.scrollTop = box.scrollHeight;
    }

    function handleAI() {
      const input = document.getElementById('ai-input');
      const query = input.value.trim().toLowerCase();
      if (!query) return;

      addMessage(input.value, 'user');
      input.value = '';

      // Simulate "Thinking" time
      setTimeout(() => {
        if (query.includes("prime")) {
          addMessage("A <strong>prime number</strong> is a whole number greater than 1 that cannot be made by multiplying other whole numbers. Its only factors are 1 and itself.<br><br>Examples: 2, 3, 5, 7, 11, 13...", "ai");
        } else if (query.includes("pi")) {
          addMessage("<strong>Pi (Ï€)</strong> is the ratio of a circle's circumference to its diameter. It's approximately 3.14159 and is an irrational number.", "ai");
        } else if (query.includes("pythagorean")) {
          addMessage("The <strong>Pythagorean Theorem</strong> states that in a right-angled triangle, the square of the hypotenuse (c) is equal to the sum of the squares of the other two sides (a and b): <strong>aÂ² + bÂ² = cÂ²</strong>.", "ai");
        } else if (query.includes("hi") || query.includes("hello")) {
          addMessage("Hi! I'm ready to help. Try asking about prime numbers, fractions, or geometry formulas!", "ai");
        } else {
          addMessage("That's an interesting question! I am currently in <em>offline mode</em>, but I can explain common math terms like prime numbers, pi, or theorems if you ask about them!", "ai");
        }
      }, 600);
    }
    
    // Allow 'Enter' key to send AI messages
    document.getElementById('ai-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleAI();
    });
  </script>
</body>
</html>
