<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculator with AI Assistant</title>
  <style>
    /* All your original styles remain exactly the same */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: #fff6fe; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding: 20px; gap: 20px; flex-wrap: wrap; }
    .calculator { background: #ffffff; width: 100%; max-width: 320px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15); overflow: hidden; }
    .side-panel { background: #ffffff; width: 100%; max-width: 400px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15); overflow: hidden; }
    .panel-tabs { display: flex; background: #f0f0f0; border-bottom: 2px solid #dc6bba; }
    .panel-tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-weight: 600; color: #666; transition: all 0.3s; }
    .panel-tab.active { background: #ffffff; color: #dc6bba; }
    .panel-content { display: none; padding: 20px; height: 600px; overflow-y: auto; }
    .panel-content.active { display: flex; flex-direction: column; }
    .chat-area { flex: 1; overflow-y: auto; margin-bottom: 15px; padding: 10px; background: #fafafa; border-radius: 8px; min-height: 400px; }
    .message { margin-bottom: 12px; padding: 10px 14px; border-radius: 12px; max-width: 85%; word-wrap: break-word; line-height: 1.5; }
    .user-message { background: #dc6bba; color: white; margin-left: auto; text-align: right; }
    .ai-message { background: #fcdcf9; color: #333; }
    .loading { background: #fcdcf9; padding: 10px 14px; border-radius: 12px; max-width: 85%; font-style: italic; color: #666; }
    .input-area { display: flex; gap: 10px; }
    .ai-input { flex: 1; padding: 12px; border: 2px solid #dc6bba; border-radius: 8px; font-size: 14px; outline: none; }
    .send-btn { padding: 12px 16px; background: #dc6bba; color: white; border: none; border-radius: 8px; cursor: pointer; }
    .equation-input { width: 100%; padding: 12px; border: 2px solid #dc6bba; border-radius: 8px; margin-bottom: 10px; }
    .solve-btn { width: 100%; padding: 15px; background: #a34582; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; }
    .solution-area { background: #fafafa; padding: 15px; border-radius: 8px; margin-top: 15px; min-height: 150px; }
    .display-area { padding: 20px 16px; text-align: right; background: #fafafa; }
    .history-text { color: #888; font-size: 14px; min-height: 20px; }
    .display { background: transparent; border: none; color: #000; font-size: 48px; text-align: right; width: 100%; outline: none; }
    .buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1px; background: #e0e0e0; }
    button { height: 60px; font-size: 20px; border: none; cursor: pointer; background: #fcdcf9; transition: all 0.2s; }
    button.operator { background: #dc6bba; color: #fff; }
    button.equal { background: #a34582; color: white; }
    .memory-buttons { display: grid; grid-template-columns: repeat(5, 1fr); gap: 1px; background: #f0f0f0; }
    .memory-btn { background: #ffffff; padding: 10px; font-size: 13px; border: none; cursor: pointer; }
    .history-item { background: white; padding: 12px; margin-bottom: 10px; border-left: 4px solid #dc6bba; border-radius: 4px; }
    @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }
  </style>
</head>
<body>

  <div class="calculator">
    <div class="header" style="padding: 10px;">
      <div class="mode">Standard Calculator</div>
    </div>
    <div class="display-area">
      <div class="history-text" id="history">&nbsp;</div>
      <input type="text" class="display" id="display" value="0" readonly>
    </div>
    <div class="memory-buttons">
      <button class="memory-btn" id="mc">MC</button>
      <button class="memory-btn" id="mr">MR</button>
      <button class="memory-btn" id="mAdd">M+</button>
      <button class="memory-btn" id="mSub">M‚àí</button>
      <button class="memory-btn" id="ms">MS</button>
    </div>
    <div class="buttons">
      <button id="percent">%</button><button id="ce">CE</button><button id="clear">C</button><button id="back">‚å´</button>
      <button id="recip">¬π‚ÅÑ‚Çì</button><button id="square">x¬≤</button><button id="sqrt">¬≤‚àöx</button><button class="operator" id="divide">√∑</button>
      <button class="number">7</button><button class="number">8</button><button class="number">9</button><button class="operator" id="multiply">√ó</button>
      <button class="number">4</button><button class="number">5</button><button class="number">6</button><button class="operator" id="subtract">‚àí</button>
      <button class="number">1</button><button class="number">2</button><button class="number">3</button><button class="operator" id="add">+</button>
      <button id="negate">+/‚àí</button><button class="number">0</button><button id="decimal">.</button><button class="equal" id="equals">=</button>
    </div>
  </div>

  <div class="side-panel">
    <div class="panel-tabs">
      <div class="panel-tab active" data-tab="chatgpt">üí¨ AI Assistant</div>
      <div class="panel-tab" data-tab="equation">üìê Equations</div>
      <div class="panel-tab" data-tab="history">üìã History</div>
    </div>

    <div class="panel-content active" id="chatgptPanel">
      <div class="chat-area" id="chatArea">
        <div class="message ai-message">Hi! I'm your Math Assistant. Ask me things like "What is a prime number?" or "Explain the pythagorean theorem!"</div>
      </div>
      <div class="input-area">
        <input type="text" id="aiInput" class="ai-input" placeholder="Ask about math..." />
        <button class="send-btn" id="sendBtn">Send</button>
      </div>
    </div>

    <div class="panel-content" id="equationPanel">
      <h3>Equation Solver</h3>
      <input type="text" id="equationInput" class="equation-input" placeholder="e.g. 2x + 5 = 13">
      <button class="solve-btn" id="solveBtn">Solve Now</button>
      <div class="solution-area" id="solutionContent">Results will appear here...</div>
    </div>

    <div class="panel-content" id="historyPanel">
      <div id="historyList"></div>
    </div>
  </div>

  <script>
    let currentVal = '0', previousVal = null, operator = null, waitingForOperand = false, memoryVal = 0, history = [];

    const displayEl = document.getElementById('display');
    const historyEl = document.getElementById('history');

    // --- TAB SYSTEM ---
    document.querySelectorAll('.panel-tab').forEach(tab => {
      tab.onclick = () => {
        document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.panel-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab + 'Panel').classList.add('active');
      };
    });

    // --- CALCULATOR LOGIC ---
    function updateDisplay() { displayEl.value = currentVal; }

    document.querySelectorAll('.number').forEach(btn => {
      btn.onclick = () => {
        const digit = btn.textContent;
        if (waitingForOperand) { currentVal = digit; waitingForOperand = false; }
        else { currentVal = currentVal === '0' ? digit : currentVal + digit; }
        updateDisplay();
      };
    });

    document.getElementById('decimal').onclick = () => {
      if (!currentVal.includes('.')) currentVal += '.';
      updateDisplay();
    };

    function handleOp(op) {
      const val = parseFloat(currentVal);
      if (previousVal === null) previousVal = val;
      else if (operator) {
        const result = calc(previousVal, val, operator);
        currentVal = String(result);
        previousVal = result;
      }
      operator = op;
      waitingForOperand = true;
      historyEl.textContent = previousVal + " " + op;
      updateDisplay();
    }

    function calc(a, b, op) {
      if (op === '+') return a + b;
      if (op === '‚àí') return a - b;
      if (op === '√ó') return a * b;
      if (op === '√∑') return b === 0 ? "Error" : a / b;
      return b;
    }

    document.getElementById('add').onclick = () => handleOp('+');
    document.getElementById('subtract').onclick = () => handleOp('‚àí');
    document.getElementById('multiply').onclick = () => handleOp('√ó');
    document.getElementById('divide').onclick = () => handleOp('√∑');

    document.getElementById('equals').onclick = () => {
      if (!operator) return;
      const result = calc(previousVal, parseFloat(currentVal), operator);
      const expr = `${previousVal} ${operator} ${currentVal} = ${result}`;
      history.push(expr);
      currentVal = String(result);
      operator = null;
      previousVal = null;
      waitingForOperand = true;
      historyEl.textContent = "";
      updateDisplay();
      updateHistoryUI();
    };

    document.getElementById('clear').onclick = () => { currentVal = '0'; previousVal = null; operator = null; historyEl.textContent = ""; updateDisplay(); };
    document.getElementById('back').onclick = () => { currentVal = currentVal.length > 1 ? currentVal.slice(0, -1) : '0'; updateDisplay(); };

    // --- MEMORY ---
    document.getElementById('ms').onclick = () => { memoryVal = parseFloat(currentVal); alert("Saved to Memory: " + memoryVal); };
    document.getElementById('mr').onclick = () => { currentVal = String(memoryVal); updateDisplay(); };
    document.getElementById('mc').onclick = () => { memoryVal = 0; };

    function updateHistoryUI() {
      document.getElementById('historyList').innerHTML = history.map(h => `<div class="history-item">${h}</div>`).reverse().join('');
    }

    // --- AI LOGIC (Simulated) ---
    const sendBtn = document.getElementById('sendBtn');
    const aiInput = document.getElementById('aiInput');
    const chatArea = document.getElementById('chatArea');

    function addMsg(text, isUser) {
      const div = document.createElement('div');
      div.className = 'message ' + (isUser ? 'user-message' : 'ai-message');
      div.textContent = text;
      chatArea.appendChild(div);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    sendBtn.onclick = () => {
      const q = aiInput.value.trim().toLowerCase();
      if (!q) return;
      addMsg(aiInput.value, true);
      aiInput.value = '';

      const loading = document.createElement('div');
      loading.className = 'loading';
      loading.textContent = "...AI is thinking";
      chatArea.appendChild(loading);

      setTimeout(() => {
        loading.remove();
        if (q.includes("prime")) addMsg("A prime number is a number greater than 1 that can only be divided by 1 and itself (like 2, 3, 5, 7, 11).", false);
        else if (q.includes("pi")) addMsg("Pi (œÄ) is approximately 3.14159. It represents the ratio of a circle's circumference to its diameter.", false);
        else if (q.includes("hello") || q.includes("hi")) addMsg("Hello! I'm your math tutor. You can ask me to explain formulas or math definitions!", false);
        else addMsg("That's a great question! In a live version with an API key, I would provide a deep explanation for '" + q + "'.", false);
      }, 1000);
    };

    // --- EQUATION SOLVER (Simulated) ---
    document.getElementById('solveBtn').onclick = () => {
      const eq = document.getElementById('equationInput').value;
      const res = document.getElementById('solutionContent');
      res.textContent = "Analyzing " + eq + "...";
      setTimeout(() => {
        res.innerHTML = "<strong>Step 1:</strong> Identify variables.<br><strong>Step 2:</strong> Isolate X.<br><br><em>Note: Real-time solving requires an active AI connection.</em>";
      }, 1000);
    };

  </script>
</body>
</html>
