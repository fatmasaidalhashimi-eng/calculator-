<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Functional AI Calculator</title>
  <style>
    /* Clean, Modern Styles */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
    body { background: #fff6fe; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding: 20px; gap: 20px; flex-wrap: wrap; }
    .calculator { background: #fff; width: 320px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
    .display-area { padding: 20px; background: #fafafa; text-align: right; border-bottom: 1px solid #eee; }
    #history-display { font-size: 14px; color: #888; height: 20px; margin-bottom: 5px; }
    #main-display { font-size: 40px; font-weight: 600; width: 100%; border: none; text-align: right; background: transparent; outline: none; }
    .buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1px; background: #eee; }
    button { height: 60px; border: none; background: #fff; font-size: 18px; cursor: pointer; transition: 0.2s; }
    button:hover { background: #fdf2fb; }
    button:active { background: #fcdcf9; }
    .operator { background: #dc6bba; color: white; font-size: 22px; }
    .operator:hover { background: #c95aa7; }
    .equal { background: #a34582; color: white; font-weight: bold; }
    .side-panel { width: 400px; background: #fff; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; height: 620px; }
    .tabs { display: flex; background: #f5f5f5; border-bottom: 2px solid #dc6bba; }
    .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-weight: 600; color: #666; }
    .tab.active { background: #fff; color: #dc6bba; }
    .content { flex: 1; padding: 20px; overflow-y: auto; display: none; }
    .content.active { display: block; }
    .chat-msg { margin-bottom: 10px; padding: 10px; border-radius: 8px; font-size: 14px; max-width: 80%; }
    .ai { background: #fcdcf9; align-self: flex-start; }
    .user { background: #dc6bba; color: white; align-self: flex-end; margin-left: auto; }
    .chat-container { display: flex; flex-direction: column; height: 400px; overflow-y: auto; background: #fafafa; padding: 10px; border-radius: 8px; }
    .input-row { display: flex; gap: 10px; margin-top: 15px; }
    input[type="text"] { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
    .send-btn { background: #dc6bba; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>

  <div class="calculator">
    <div class="display-area">
      <div id="history-display"></div>
      <input type="text" id="main-display" value="0" readonly>
    </div>
    <div class="buttons">
      <button onclick="clearDisplay()">C</button>
      <button onclick="deleteLast()">âŒ«</button>
      <button onclick="appendOperator('/')" class="operator">Ã·</button>
      <button onclick="appendOperator('*')" class="operator">Ã—</button>
      
      <button onclick="appendNumber('7')">7</button>
      <button onclick="appendNumber('8')">8</button>
      <button onclick="appendNumber('9')">9</button>
      <button onclick="appendOperator('-')" class="operator">âˆ’</button>
      
      <button onclick="appendNumber('4')">4</button>
      <button onclick="appendNumber('5')">5</button>
      <button onclick="appendNumber('6')">6</button>
      <button onclick="appendOperator('+')" class="operator">+</button>
      
      <button onclick="appendNumber('1')">1</button>
      <button onclick="appendNumber('2')">2</button>
      <button onclick="appendNumber('3')">3</button>
      <button onclick="calculate()" class="equal" style="grid-row: span 2">=</button>
      
      <button onclick="appendNumber('0')" style="grid-column: span 2">0</button>
      <button onclick="appendNumber('.')">.</button>
    </div>
  </div>

  <div class="side-panel">
    <div class="tabs">
      <div class="tab active" onclick="showTab('ai-tab')">ðŸ’¬ AI</div>
      <div class="tab" onclick="showTab('history-tab')">ðŸ“‹ History</div>
    </div>
    
    <div id="ai-tab" class="content active">
      <div class="chat-container" id="chat-box">
        <div class="chat-msg ai">Hello! I am your Math AI. Ask me about prime numbers, algebra, or geometry!</div>
      </div>
      <div class="input-row">
        <input type="text" id="ai-input" placeholder="What is a prime number?">
        <button class="send-btn" onclick="askAI()">Ask</button>
      </div>
    </div>

    <div id="history-tab" class="content">
      <div id="history-list">No calculations yet.</div>
    </div>
  </div>

  <script>
    let display = document.getElementById('main-display');
    let historyBox = document.getElementById('history-display');
    let historyList = [];

    // --- CALCULATOR FUNCTIONS ---
    function appendNumber(num) {
      if (display.value === '0') display.value = num;
      else display.value += num;
    }

    function appendOperator(op) {
      let lastChar = display.value.slice(-1);
      if (['+','-','*','/'].includes(lastChar)) {
        display.value = display.value.slice(0, -1) + op;
      } else {
        display.value += op;
      }
    }

    function clearDisplay() {
      display.value = '0';
      historyBox.innerText = '';
    }

    function deleteLast() {
      display.value = display.value.slice(0, -1) || '0';
    }

    function calculate() {
      try {
        let expression = display.value;
        // Clean the expression for math
        let result = eval(expression.replace('Ã—', '*').replace('Ã·', '/'));
        historyBox.innerText = expression + ' =';
        display.value = result;
        
        // Add to history list
        historyList.push(expression + " = " + result);
        updateHistoryUI();
      } catch (e) {
        display.value = "Error";
      }
    }

    function updateHistoryUI() {
      let container = document.getElementById('history-list');
      container.innerHTML = historyList.map(item => `<div style="padding:10px; border-bottom:1px solid #eee">${item}</div>`).reverse().join('');
    }

    // --- AI FUNCTIONS ---
    function showTab(tabId) {
      document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      event.currentTarget.classList.add('active');
    }

    function addChat(text, type) {
      let msg = document.createElement('div');
      msg.className = `chat-msg ${type}`;
      msg.innerText = text;
      document.getElementById('chat-box').appendChild(msg);
      document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
    }

    function askAI() {
      let input = document.getElementById('ai-input');
      let query = input.value.trim().toLowerCase();
      if (!query) return;

      addChat(input.value, 'user');
      input.value = '';

      setTimeout(() => {
        if (query.includes("prime")) {
          addChat("A prime number is a natural number greater than 1 that has no positive divisors other than 1 and itself. Examples: 2, 3, 5, 7, 11.", "ai");
        } else if (query.includes("pi")) {
          addChat("Pi (Ï€) is the ratio of a circle's circumference to its diameter, approximately 3.14159.", "ai");
        } else if (query.includes("pythagorean")) {
          addChat("The Pythagorean theorem states that in a right-angled triangle, the square of the hypotenuse is equal to the sum of the squares of the other two sides: aÂ² + bÂ² = cÂ².", "ai");
        } else {
          addChat("I'm a math specialist! Try asking about numbers, formulas, or constants.", "ai");
        }
      }, 600);
    }
  </script>
</body>
</html>
